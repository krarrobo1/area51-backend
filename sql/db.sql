

CREATE TABLE IF NOT EXISTS empresas
(
id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
nombre VARCHAR NOT NULL UNIQUE,
latitud NUMERIC(9,6)
longitud NUMERIC(9,6),
estado BOOLEAN DEFAULT true NOT NULL
);





CREATE TABLE IF NOT EXISTS cargos(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    empresaid integer references empresas(id),
    nombre VARCHAR(50) NOT NULL
);


CREATE TABLE IF NOT EXISTS periodos(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    cargoid integer references cargos(id) NOT NULL,
    diaid integer references dias(id) NOT NULL,
    horainicio TIME NOT NULL,
    horafin TIME NOT NULL
);



CREATE TABLE IF NOT EXISTS dias(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    nombre VARCHAR(10)
);

INSERT INTO dias(nombre) VALUES('Lunes');
INSERT INTO dias(nombre) VALUES('Martes');
INSERT INTO dias(nombre) VALUES('Miercoles');
INSERT INTO dias(nombre) VALUES('Jueves');
INSERT INTO dias(nombre) VALUES('Viernes');
INSERT INTO dias(nombre) VALUES('Sabado');
INSERT INTO dias(nombre) VALUES('Domingo');


CREATE TABLE IF NOT EXISTS empleados
(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	empresaid integer references empresas(id),
    cargoid integer references cargos(id),
    nombres VARCHAR(80) NOT NULL CHECK(nombres <> ''),
    apellidos VARCHAR(80) NOT NULL CHECK(apellidos <> ''),
    ci VARCHAR(10),
    email VARCHAR(80) NOT NULL UNIQUE,
    password text NOT NULL
);

INSERT INTO EMPLEADO(id_empresa, nombres, apellidos, ci, email, password) VALUES (1, 1, 'William', 'Borja', '1101234567', 'willyborja@gmail.com','A1Q29920A9X0AS9D9ASDAS0asda12');
INSERT INTO EMPLEADO(id_empresa, nombres, apellidos, ci, email, password) VALUES (1, 2,'Bruno', 'Esparza', '1101234567', 'baezparsa@gmail.com','A1Q29920A9X0AS9D9ASDAS0as2da12');
SELECT * FROM EMPLEADO WHERE ID_EMPRESA = 1;

CREATE TABLE IF NOT EXISTS dispositivos
(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    empleadoid integer references empleados(id) NOT NULL,
    ip CIDR,
    mac MACADDR,
    modelo VARCHAR
);


CREATE TABLE IF NOT EXISTS dispositivos
(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    empleadoid integer references empleados(id),
    nombre VARCHAR,
    ip CIDR,
    mac MACADDR,
    modelo VARCHAR
);


CREATE TABLE IF NOT EXISTS asistencias
(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    dispositivoid integer references dipositivos(id),
    empleadoid integer references empleados(id)
    hora TIMESTAMP,
    latitud NUMERIC(9,6),
    longitud NUMERIC(9,6),
    eventoid references eventos(id) 
);

CREATE TABLE IF NOT EXISTS eventos
(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    nombre VARCHAR
);

INSERT INTO EVENTOS(nombre) VALUES ('Entrada');
INSERT INTO EVENTOS(nombre) VALUES ('Salida');

CREATE TABLE IF NOT EXISTS PERMISOS
(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    nombre VARCHAR
);

INSERT INTO PERMISOS(nombre) values ('Vacaciones');
INSERT INTO PERMISOS(nombre) values ('Intempestivo');


CREATE TABLE IF NOT EXISTS DETALLEPERMISOS(
    id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    empleadoid integer references empleados(id),
    fechainicio TIMESTAMP,
    fechafin TIMESTAMP,
    permisoid integer references permisos(id),
    estado BOOLEAN
);
